# Python Basic

## 简介

- 应用
  - 网络应用， 如网站， 后台服务等
  - 日常小工具， 如系统管理员需要的脚本
  - 把其他语言开发的程序再包装起来， 方便使用
- 缺点
  - 运行速度慢， 因为 Python 是解释型语言
  - 代码不能加密。如果要发布你的Python程序，实际上就是发布源代码，这一点跟C语言不同，C语言不用发布源代码，只需要把编译后的机器码（也就是你在Windows上常见的xxx.exe文件）发布出去。要从机器码反推出C代码是不可能的，所以，凡是编译型的语言，都没有这个问题，而解释型的语言，则必须把源码发布出去。这个缺点仅限于你要编写的软件需要卖给别人挣钱的时候。好消息是目前的互联网时代，靠卖软件授权的商业模式越来越少了，靠网站和移动应用卖服务的模式越来越多了，后一种模式不需要把源码给别人。
- 2.x or 3.x
  - 两个版本是不兼容的， 现在 Python 正在朝着 3.x 版本进化， 在进化过程中， 大量的针对 2.x 版本的代码要修改后才能运行。


## 基础

### 基础语法

- 大小写敏感
- 采用缩进的方式来标明代码的隶属关系 [代码块]
- 当语句以冒号 ":" 结尾时， 缩进的语句视为代码块
- 缩进的利弊
  - 利： 
    - 强迫写出格式化的代码
    - 强迫写出缩进较少的代码， 这样就会倾向于把一段很长的代码拆分成若干个函数， 从而得到缩进减少的代码和耦合。
  - 弊： 
    - 没有规定缩进的大小， 是几个空格还是 Tab， 建议始终坚持使用 <u>**4个空格**</u>
    - 『复制-粘贴』功能失效了。

---

### 输入和输出

- 输出: print。 输出多个字符串的时候， 需要用逗号 "," 隔开， 就可以炼成一串输出了， 输出时， 每个字符串之间用*空格* 隔开。
  - `print 'hello world'`
  - `print 'The quick brown fox', 'jumps over', 'the lazy dog'`
  - `print 300`
  - `print '100 + 200 = ', 100 + 200`
- 输入: raw_input(string)
  - arguments:
    - string[optional]: input tips
  - `name = raw_input()`
  - `name = raw_input('please enter you name: ')`

---

### 数据类型和变量

- 整数： 可以处理任意大小的整数， 当然包括负整数。

- 浮点数： 之所以称为浮点数， 是因为按照科学记数法表示时， 一个浮点数的小数点位置是可变的。 浮点数也可以用数学写法， 但是对于很大或很小的浮点数， 就必须用科学记数法表示。

  **注意**： 整数和浮点数在计算机内部存储的方式是不同的， 整数运算永远是精确的， 而浮点数运算则可能会有四舍五入的误差。

- 字符串： 以`''` 或 `""` 括起来的任意文本。 

  - 注意一些字符的转义字符。
  - 字符串里面有很多字符都需要转义，就需要加很多`\`，为了简化，Python还允许用`r''`表示`''`内部的字符串默认不转义。
  - 字符串内部有很多换行，用`\n`写在一行里不好阅读，为了简化，Python允许用`'''...'''`的格式表示多行内容

- 布尔值： 布尔值和布尔代数的表示完全一致，一个布尔值只有`True`、`False`两种值（注意大小写）。也可以通过布尔运算（`3 > 2`）计算出来。布尔值的运算符有`and`、`or`和`not`。

- 空值： 空值是Python里一个特殊的值，用`None`表示。`None`不能理解为`0`，因为`0`是有意义的，而`None`是一个特殊的空值。

- 变量： 

  - 变量名必须是大小写英文、数字和`_`的组合，且不能用数字开头
  - 等号`=`是赋值语句，可以把任意数据类型赋值给变量，同一个变量可以反复赋值，而且可以是不同类型的变量
  - 理解变量在计算机内存中的表示， 以`a = 'ABC'` 为例
    - 在内存中创建了一个`'ABC'`的字符串；
    - 在内存中创建了一个名为`a`的变量，并把它指向`'ABC'`。
    - 把一个变量`a`赋值给另一个变量`b`，这个操作实际上是把变量`b`指向变量`a`所指向的数据

  **PS**： 变量本身类型不固定的语言称之为动态语言，与之对应的是静态语言。静态语言在定义变量时必须指定变量类型，如果赋值的时候类型不匹配，就会报错。例如Java。 和静态语言相比，动态语言更灵活，就是这个原因。

- 常量： 不能变的变量， 通常用全部大写的变量名表示常量


**Note**：

- Python 的<u>**数字类型**</u>可分为： ==int, long, float, complex==
- ​

---

### 字符串和编码

**编码**

- 因为计算机只能处理数字，如果要处理文本，就必须先把文本转换为数字才能处理。

- `ASCII`编码: 1 byte。 127个字母被编码到计算机里，也就是大小写英文字母、数字和一些符号。 比如大写字母`A`的编码是`65`，小写字母`z`的编码是`122`。常用函数有 `ord()` 和 `chr()`， 进行 ASCII 编码与数字之间进行转化

- `GB2312`编码: 要处理中文显然一个字节是不够的，至少需要两个字节，而且还不能和ASCII编码冲突，所以，中国制定了`GB2312`编码，用来把中文编进去。

- `Unicode` 编码: 2byte。 Unicode把所有语言都统一到一套编码里，这样就不会再有乱码问题了。

- `UTF-8` 编码: 可变长编码。 本着节约的精神，又出现了把Unicode编码转化为“可变长编码”。 UTF-8编码把一个Unicode字符根据不同的数字大小编码成1-6个字节，常用的英文字母被编码成1个字节，汉字通常是3个字节，只有很生僻的字符才会被编码成4-6个字节。如果你要传输的文本包含大量英文字符，用UTF-8编码就能节省空间。 UTF-8编码有一个额外的好处，就是ASCII编码实际上可以被看成是UTF-8编码的一部分，所以，大量只支持ASCII编码的历史遗留软件可以在UTF-8编码下继续工作。

  **PS**： 日本把日文编到`Shift_JIS`里，韩国把韩文编到`Euc-kr`里，各国有各国的标准，就会不可避免地出现冲突，结果就是，在多语言混合的文本中，显示出来会有乱码。

总结一下现在计算机系统通用的字符编码工作方式：

- 在计算机内存中，统一使用Unicode编码，当需要保存到硬盘或者需要传输的时候，就转换为UTF-8编码。
- 用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到内存里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件。
- 浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器。

**字符串**

- 因 Python 的诞生笔 `Unicode 编码`发布的时间还要早， 故最早的 Python 只支持 `ASCII 编码`， 普通的字符串 `ABC` 在 Python 内部都是 `ASCII 编码` 的， Python 提供了 `ord()` 和 `chr()` 函数， 可以把字母和对应的数字相互转换。

- Python在后来添加了对Unicode的支持，以Unicode表示的字符串用`u'...'`表示。 

  - 写`u'中'`和`u'\u4e2d'`是一样的，`\u`后面是十六进制的Unicode码。
  - 把`u'xxx'`转换为UTF-8编码的`'xxx'`用`encode('utf-8')`方法， 英文字符转换后表示的UTF-8的值和Unicode值相等（但占用的存储空间不同），而中文字符转换后1个Unicode字符将变为3个UTF-8字符。 `len()`函数可以返回字符串的长度（一个中文的长度为1）。 `encode(param)` 中的 param 可以是其他编码。
  - 把UTF-8编码表示的字符串`'xxx'`转换为Unicode字符串`u'xxx'`用`decode('utf-8')`方法。

- 由于Python源代码也是一个文本文件，所以，当你的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为UTF-8编码。当Python解释器读取源代码时，为了让它按UTF-8编码读取，我们通常在文件开头写上这两行:

  ```python
  #!/usr/bin/env python
  # -*- coding: utf-8 -*-
  ```

  - 第一行注释是为了告诉Linux/OS X系统，这是一个Python可执行程序，Windows系统会忽略这个注释
  - 第二行注释是为了告诉Python解释器，按照UTF-8编码读取源代码，否则，你在源代码中写的中文输出可能会有乱码。

**如何输出格式化的字符串**

- 在Python中，采用的格式化方式和C语言是一致的，用`%`实现。`%`运算符就是用来格式化字符串的。在字符串内部，`%s`表示用字符串替换，`%d`表示用整数替换，有几个`%?`占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个`%?`，括号可以省略。常用的占位符如下：
  - %d： 整数
  - %f： 浮点数
  - %s： 字符串
  - %x： 十六进制整数
- 格式化整数和浮点数还可以指定是否补 0 和整数与小数的位数。
- 如果不太确定应该用什么， `%s` 永远起作用， 它会把任何数据类型转换为字符串。
- 对于 Unicode 字符串， 用法完全一样， 但最好确保替换的字符串也是 Unicode 字符串， 如 `u'Hi, %s.'% u'Abner'`.
- 字符串里面的 `%` 是一个普通字符是， 用 `%%` 来表示一个 `%`

**Note**： Python 2.x版本虽然支持Unicode，但在语法上需要`'xxx'`和`u'xxx'`两种字符串表示方式。在Python 3.x版本中，把`'xxx'`和`u'xxx'`统一成Unicode编码，即写不写前缀`u`都是一样的，而以字节形式表示的字符串则必须加上`b`前缀：`b'xxx'`。

---

### 运算

- 数学： +, -, *, /, **, %
- 判断： ==, !=, >, >=, <, <=, in
- 逻辑： and, or, not

---

### 条件判断与循环

- 条件判断： 计算机自动执行的基础。 `if condition1: ...elif condition2: ... else: ...`

- 循环： 让计算机重复计算

  - For-in 循环：

    ```python
    for item in list:
    	statemnet
    ```

  - While 循环

    ```python
    while condition:
    	statement
    ```

- 中断循环：

  - continue: 
  - break:

---

### 常用的数据结构

- Tuple： 元祖， 值不可变更， 用 `()` 来声明
- List： 表， 是一个**有序**集合， 值可以变更， 可以随时添加和删除其中元素。 用 `[]` 来声明。
  - 引用： 下标， [下限: 步长: 上限]。 当下标超出了范围时， Python 会报一个 *IndexError* 错误。 最后一个元素的下标是 `len(list) - 1`。 如果要取最后一个元素， 除了计算下标位置外， 还可以用 *-1* 做下标， 直接获取最后一个元素。 以此类推， 可以获取倒数第 2 个， 倒数第 3 个 …...
  - 替换： list[index] = xxx
  - 常用方法：
    - append(item)： 在 list 中追加 item 到末尾
    - insert(index, item)： 在 list 中指定位置(index) 插入 item
    - pop(index)： index 为空时， 删除 list 末尾的元素并返回， 否则删除 index 对应位置的元素并返回。
    - len()： 获得 list 元素的个数
- Dictionary： 字典， 用 `{}` 来声明
  - 常用方法：
    - keys()
    - values()
    - items()
    - clear()
    - del(dic[key])

---

### 错误处理

-  函数返回值。 通过函数返回值来标识错误类型， 程序执行是否正确。

-  异常处理

   ```python
       try:
       	...
       except exception1:
       	...
       except exception2:
       	...
       except
       	...
       else:
       	...
       finally:
       	...
   ```

### 函数

- 定义及调用

  - 函数：实现特定功能， 并能重复利用的代码

  ```python
  def func_name(a, b, ...):
  	statement # 功能实现
  	return v1, v2, ... # 放回结果
  ```

  - 若没有return， 或 return 后无返回值， 函数将自动返回 None

- 参数传递

  - 位置传递
  - 关键字传递
  - 参数默认值
  - 包裹传递（packing） VS 解包裹（unpacking）
  - 先位置， 后关键字， 包裹位置， 包裹关键字

- 函数对象

  - 函数即是对象

  - Lambda 生成一个函数对象

    ```python
    func = lambda a, b: a + b
    ```

  - 函数作为参数传递

    ```python
    func = lambda a, b: a + b
    def sum(f, x, y):
    	print '------- in sum function -------'
    	print f(x, y)
    ```

---

### 面向对象

- 类和对象
  - 面向过程和面向对象的编程
    - 面向过程编程： 函数式编程， C 程序等
    - 棉线独享的编程： C++， Java， Python 等
  - 类和对象： 是面向对象的两个重要概念
    - 类： 是对事物的抽象
    - 对象： 是类的一个实例
  - 类的组成： 由变量和函数组成
    - 变量： 属性， 类中的变量称为『成员变量』
    - 函数： 类中的函数称为『成员函数』
  - 对象的组成：对象由类实例化后得到， 所以也由变量和函数组成
  - Python 类的定义
    - 使用 `class` 关键字顶一个类， 并且类名的首字母要大写
    - 类里面包含了变量和方法， 这种包含也称之为『封装』类里面包含了变量和方法， 这种包含也称之为『封装』类里面包含了变量和方法， 这种包含也称之为『封装』类里面包含了变量和方法， 这种包含也称之为『封装』
  - Python 对象的创建
    - `myClass1 = MyClass() # 创建类的一个实例`
    - 引用对象的属性： `myClass1.attr`
- 属性和方法
  - 通过 `self` 调用类属性
  - 对象生成时自动执行的特殊方法： `__init__()`
  - 通过 self 增加对象属性
  - 类的属性是对数据的封装， 方法则是对类的行为的封装
  - 类的属性
    - 公有属性： 在类中和类外调用的属性
    - 内置属性： 由系统在定义类的时候默认添加的， 由前后两个下划线构成`__dict__`, `__module__`
    - 私有属性： 不能被类以外的函数调用，定义时在属性名前加 __
  - 类的方法
    - 方法的定义： self 作为第一个参数
    - 分类：
      - 私有方法： 不能被外部的类和方法调用， 定义： 加双下划线 __
      - 类方法： 被 `classmehod()` 函数处理过的函数
      - 静态方法： 相当于 『全局函数』， 其中无 "self" 语句
    - self 参数： 指向对象本身
- 继承
  - 类别本身还可以进一步细分成自雷
  - 继承： 子类对父类属性和方法的共享


---

### 模块

- 模块安装
  - 安装包管理工具： pip
    - Anaconda 套件自带 pip
    - 下载安装
      - setuptools：
      - pip：
  - 安装模块： `pip install module_name`
- 模块使用
  - 导入模块
    - import mod_name # 引入模块
    - import mod_name as k # 引入模块并重命名为 k
    - form mod_name import func # 从 m 中引入函数， 直接使用
    - from mod_name import * # 从 m 中引入所有对象， 直接使用
  - 模块的使用： mod_name.obj
  - 模块搜索路径
    - 程序所在目录
    - 标准库的安装路径
    - 操作系统环境变量 *PYTHONPATH* 指向的路径 `export PYTHONPATH = $PYATHONPATH:<mod_path>`
- 构建模块
  - 构建 .py 文件
  - 模块包： 同一个文件夹下功能相似的模块
  - 声明模块包： `__init__.py`
  - from 模块包 import x # 从模块包中引入模块 x
- Python 标准库
  - 正则表达式 (re包)
  - 时间和日期 (time, datatime包)
  - 路径与文件 (os.path 包， glob 包)
  - 文件管理 (部分 os 包， shutil 包)
  - 存储对象 (pickle 包， cPickle 包)
  - 子进程 (subprocess 包)
  - 信号 (signal 包)
  - 线程同步 (threading 包)
  - 进程信息 (部分 os 包)
  - 多线程初步 (multiprocessing 包)
  - 数学 (math 包)
  - 随机数 (random 包)
  - 循环器 (itertools 包)
  - 数据库 (sqlite3)
  - Python2: https://doc.python.org/2/library
  - Python3: https://doc.python.org/3/library/index.html

---

###  Python 高级特性

- 特殊方法

  Python 中一切皆对象

  - 以双下划线开头， 并以双下划线结尾
  - \_\_方法名\_\_, 例如： \_\_init\_\_
  - 可通过 `dir()` 查看
  - 运算符
  - 列表
  - 函数

- 对象属性

  - 对象的属性
  - 特性 @property。 四个参数说明如下：
    - 获取对象属性
    - 设置对象属性
    - 删除对象属性
    - 描述
  - 查询即时生成的属性: \_\_getattr\_\_

- 上下文管理器 (Context Manager)

  - 规定对象的适用范围， 超越范围则 『采取处理』`with...as...` 代码块

  - 任何定义了 \_\_enter\_\_() 和\_\_exit\_\_() 方法的对象都可以用于上下文管理器

    ```python
    with EXPR as VAR
    VAR = EXPR
    VAR = VAR.__enter__()
    try:
        BLOCK
    finally:
        VAR.__exit__()
    ```

- 闭包 (Closure)

  定义： 一个包含有环境变量取值的函数对象。 是一种组织代码的结构， 提高了代码的可重复使用性。

- 装饰器 (decorator)

  - 可以包装函数， 类的『函数』
  - 包含函数的装饰器
    - 无参
    - 含参
  - 包装类的装饰器

- 内存管理

  - 内存状况
  - 引用计数 (reference count)。可以使用 sys 包中 getrefcount(param) 函数查看引用增加， 减少
  - 对象引用对象
  - 垃圾回收 (garbage collection)
  - 阈值：
    - gc.set_threshold()
    - gc.get_threshold() (700, 10, 10)
  - 分代 (generation) 回收策略： 0， 1， 2
  - 孤立 『引用环』 的问题

---

### Python 进阶

- 循环设计
  - 循环对象
    - 包含有一个 next() 方法的对象
    - 穷举结束后， 抛出 StopInteration 错误
  - 迭代器
    - 用 iter() 函数返回迭代器对象
  - 生成器 (generator)
    - 构成一个用户自定义的循环对象
    - yield 关键字
    - <font color='red'>*</font> 生成器表达式 (Generator Expression)
  - 表推到 (list comprehension)
    - 快速生成表的方法
- 动态类型
  - 动态类型 (dynamic typing)
    - 引用 (reference)
    - 引用与对象分离
  - 传值 (值传递)
  - 传址 (指针传递)
- 文件读写
  - 创建文件对象： `f = open(文件名, 模式)`， 具体模式如下
    - r (只读)
    - w (写入)
  - 文件对象的方法：
    - 读取: f.read(N), f.readline(), f.readlines()
    - 写入: f.write(str)
    - 关闭: f.close()
- OOP 常见函数
  - hasattr(o, f) # 查看对象 o 是否含有 f 属性
  - getattr(o,f) # 获取对象 o 中 f 的属性值
  - setattr(o, f, new_f) # 将 f 属性设为 new_f
  - delattr(o, f) # 删除 f 属性
  - isinstance(o, c) # 对象 o 是否为类 c 的实例
  - issubclass(c, par) # 类 c 是否为类 par 的子类

---

### Python 数据库操作

- Python 操作 Sqlite 数据库
  - Sqlite3 是数据库 SQLite 的访问接口
  - SQLite 是一个轻量级的关系型数据库
    - 移动或桌面应用
    - Python 自带
  - 如何使用 ？ 『四部曲』
    - import sqlite3
    - 创建数据库连接 (connection)
    - 使用游标 (cursor)
    - 通过游标执行 SQL 语句， 获得结果
- Python 操作 Mysql 数据库
  - 安装支持 Python 的 MySQL 驱动
    - pip install MySQL-python [封装了 MySQL C 驱动的 Python 驱动]
    - pip install mysql-connector-python [MySQL 官方的纯 Python 驱动]
  - 如何使用？ [与 sqlite3 一致]
    - import MySQLdb
    - 创建数据库连接
    - 获取游标
    - 执行 SQL 语句

## Python 爬虫

### Python 爬虫基础



---

### Python 爬虫实例





---

# built-in function

- range(int): 

# IPython notebook

## IPython notebook 是什么

- 一种新兴的交互式数据分析与记录工具
- 既是一个交互计算平台， 又是一个记录计算过程的『笔记本』
- 它定义了一种全新的计算文件格式， 其中包含了代码， 代码说明以及每一步的计算输出（数值或图片等）
- 它是数据分析， 科学分析， 交互式计算的『利器』

## IPython notebook 架构

- 有服务端和客户端两部分组成
- 服务端负责代码的解释与计算
- 客户端负责与用户进行交互
- 服务端可以运行在本机， 也可以运行在远程服务端， 包含负责运算的 IPython kernel 和一个 HTTP/S 服务器(Tornado)
- 客户端则是一个指向服务端地址的浏览器页面， 负责接收用户的输入并负责渲染输出

## Why IPython notebook

- 在命令行中输入了许多语句后， 希望将其部分或全部保存至一个脚本文件中以便记录计算过程
- 脚本运行出错， 需要对脚本进行局部修改后继续运行， 但不想重新运行之前已执行完的语句
- 希望将详细计算过程及结果与他人共享， 以便与他人讨论数据分析步骤或让他人重复你的结果
- 希望在本地的台式机或笔记本上对远程服务器中的数据进行分析， 却不想讲数据拷贝至本地

## IPython notebook 安装

- 通过 pip 等工具一步一步安装。 费时费力， 坑太多， 新手不建议
- 安装 Anaconda 从而获得 iPython
  - 一键式安装， 简单
  - 几乎包含了所有计算的库
  - [下载地址](https://www.continuum.io/downloads)
- 通过其他 python 发行套件暗转， ex：
  - Enthough Python Distribution(EPD)
  - Python(x,y)

##  




## 补充

- `\#!/usr/bin/env python`: 用来指定用什么解释器运行脚本以及解释器所在的位置
- `-*- coding: utf-8 -*-`: 用来指定文件编码格式， 参见 [PEP 0263](http://www.python.org/dev/peps/pep-0263/)
- ​