### 0 目录

### 1 简介
企业号是微信为企业客户提供的移动应用入口。它帮助企业建立员工、上下游供应链与企业IT系统间的连接。利用企业号，企业或第三方合作伙伴可以帮助企业快速、低成本的实现高质量的移动轻应用，实现生产、管理、协作、运营的移动化。

可以登录企业号的管理页面，导入通讯录、配置应用、邀请成员关注该企业号，也可以通过应用向成员发送文本、图文、文件、视频、音频等多媒体消息。通过简单的配置，就可以自动回复成员发送的消息，实现公告通知、知识管理、企业文化建设、手机企业通讯录等基本的企业应用。还可以通过本文档所描述的接口，建立企业号同企业应用间的连接，实现更多丰富且个性化的企业移动应用。

### 2 企业号

#### 2.1 建立连接
**连接**将使你的企业号更具价值，你可以使用以下**三种方式**，连接你的企业号及企业应用：

1.  企业应用调用企业号提供的接口，管理或查询企业号后台所管理的资源、或给成员发送消息等，以下称**主动调用模式**。
2. 企业号把用户发送的消息或用户触发的事件推送给企业应用，由企业应用处理，以下称**回调模式**。
3. 用户在微信中阅读企业应用下发的H5页面，该页面可以调用微信提供的原生接口，使用微信开放的终端能力，以下称**JSAPI模式**。

通过这三种连接方式的结合，你可以在企业号中建立功能强大的移动轻应用，并依托微信数亿活跃用户，帮助企业方便、快捷地实现应用的部署，并确保应用的活跃度。

##### 2.1.1 主动调用
###### 2.1.1.1 主动调用
主动调用是最基本的连接模式，当你的应用调用企业号时，需使用**Https协议、Json数据格式、UTF8编码，访问域名为<https://qyapi.weixin.qq.com>，数据包不需要加密**。

在每次主动调用企业号接口时需要带上*AccessToken*参数。AccessToken参数由*CorpID*和*Secret*换取。

*CorpID*是企业号的标识，每个企业号拥有一个唯一的CorpID；  
*Secret*是管理组凭证密钥。

系统管理员可通过管理端的权限管理功能创建管理组，分配管理组对应用、通讯录的访问权限。完成后，管理组即可获得唯一的secret。系统管理员可通过权限管理查看所有管理组的secret，其他管理员可通过设置中的开发者凭据查看。

当企业应用调用企业号接口时，企业号后台为根据此次访问的AccessToken,校验访问的合法性以及所对应的管理组的管理权限以返回相应的结果。

**注**：你应该审慎配置管理组的权限，够用即好，权限过大会增加误操作可能性及信息安全隐患。

###### 2.1.1.2 获取AccessToken
AccessToken是企业号的全局唯一票据，调用接口时需携带AccessToken。

AccessToken需要用*CorpID*和*Secret*来换取，不同的Secret会返回不同的AccessToken。**正常情况下AccessToken有效期为7200秒，有效期内重复获取返回相同结果；有效期内有接口交互（包括获取AccessToken的接口），会自动续期**。   

- 请求说明   
    Https请求方式: GET   
    请求链接： <https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=id&corpsecret=secrect>   
- 参数说明
    <table>
        <tr>
            <th>**参数** </th>
            <th>**必须** </th>
            <th>**说明**</th>
        </tr>
        <tr>
            <td>corpid</td>
            <td>是</td>
            <td>企业Id</td>
        </tr>
        <tr>
            <td>corpsecret</td>
            <td>是</td>
            <td>管理组的凭证密钥</td>
        </tr>
    </table>
- 权限说明  
    每个secret代表了对应用、通讯录的不同权限；不同的管理组拥有不同的secret。   
- 返回说明
    * 正确的Json返回结果:    
    
            {
               "access_token": "accesstoken000001",         
               "expires_in": 7200
            }
        <table>
            <tr>
                <th>参数</th>
                <th>说明</th>
            </tr>
            <tr>
                <td>access_token</td>
                <td>获取到的凭证</td>
            </tr>
            <tr>
                <td>expires_in</td>
                <td>凭证的有效时间(秒)</td>
            </tr>
        <table>
    * 错误的Json返回示例:   
    
            {
               "errcode": 43003,   
               "errmsg": "require https"
            }   
 

 
 
###### 2.1.1.3 主动调用的频率限制
当你获取到AccessToken时，你的应用就可以成功调用企业号后台所提供的各种接口以管理或访问企业号后台的资源或给企业号成员发消息。

为了防止企业应用的程序错误而引发企业号服务器负载异常，默认情况下，每个企业号调用接口都有一定的频率限制，当超过此限制时，调用对应接口会收到相应错误码。

以下是当前默认的频率限制，企业号后台可能会根据运营情况调整此阈值：

基础频率
每企业调用单个cgi/api不可超过1000次/分，30000次/小时

每ip调用单个cgi/api不可超过2000次/分，60000次/小时

发消息频率
每企业不可超过帐号上限数*30人次/天

创建帐号频率
每企业创建帐号数不可超过帐号上限数*3/月

创建应用频率
每企业最大应用数限制为30个，创建应用次数不可超过30*3/月



## 2.1.2 回调模式
